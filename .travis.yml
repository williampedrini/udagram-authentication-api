language: node_js

node_js: 12

services:
  - 'docker'

script:
  - 'make build'

after_success:
  - 'docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD'
  - 'make push-image'
  - 'make aws-client'
  - 'make aws-credentials'
  - 'make aws-eksctl'
  - 'make aws-eksctl-configuration'
  - 'make kubectl'
  - 'make deployment'

# don't notify when things fail
notifications:
  email: false
